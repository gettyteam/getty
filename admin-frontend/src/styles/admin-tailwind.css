@import '../../../src/theme-tokens.css';
@import './util.css';

@tailwind base;
@tailwind components;
@tailwind utilities;

@layer utilities {
  @media (max-width: 767.98px) {
    .admin-container .theme-toggle {
      width: 2rem;
      height: 2rem;
    }

    .admin-container .theme-toggle svg {
      width: 1rem;
      height: 1rem;
    }
  }
}

@layer base {
  input:not([type='checkbox']):not([type='radio']):not([type='range']),
  select,
  textarea {
    border-color: var(--border-color);
    color: var(--text-primary);
  }
  input::placeholder,
  textarea::placeholder {
    color: var(--text-secondary);
    opacity: 0.7;
  }

  [multiple]:focus,
  [type='date']:focus,
  [type='datetime-local']:focus,
  [type='email']:focus,
  [type='month']:focus,
  [type='number']:focus,
  [type='password']:focus,
  [type='search']:focus,
  [type='tel']:focus,
  [type='text']:focus,
  [type='time']:focus,
  [type='url']:focus,
  [type='week']:focus,
  input:where(:not([type])):focus,
  select:focus,
  textarea:focus {
    outline: 1px solid transparent;
    outline-offset: 1px;
    --tw-ring-inset: var(--tw-empty, /*!*/ /*!*/);
    --tw-ring-offset-width: 0px;
    --tw-ring-offset-color: #fff;
    --tw-ring-color: #777777;
    --tw-ring-offset-shadow: var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width)
      var(--tw-ring-offset-color);
    --tw-ring-shadow: var(--tw-ring-inset) 0 0 0 calc(1px + var(--tw-ring-offset-width)) #777777;
    border-color: var(--border-color);
    box-shadow:
      var(--tw-ring-offset-shadow), var(--tw-ring-shadow), var(--tw-shadow, 0 0 #00000000);
  }

  html.dark input:not([type='checkbox']):not([type='radio']):not([type='range']),
  html.dark select,
  html.dark textarea {
    border-color: var(--border-color);
    background-color: color-mix(in srgb, var(--card-bg) 55%, transparent);
    color: var(--text-primary);
  }
  html.dark input::placeholder,
  html.dark textarea::placeholder {
    color: var(--text-secondary);
    opacity: 0.55;
  }
}

@layer components {
  .icon-badge {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    line-height: 1;
    flex-shrink: 0;
  }
  .icon-badge svg {
    stroke: currentColor;
    color: currentColor;
  }
  .icon-badge--sm {
    width: 20px;
    height: 20px;
    font-size: 12px;
  }
  .icon-badge--md {
    width: 24px;
    height: 24px;
    font-size: 12px;
  }
  .icon-badge--primary {
    background: #553fee;
    color: #fff;
  }
  html.dark .icon-badge--primary {
    background: #553fee;
    color: #fff;
  }
  .icon-badge--neutral {
    background: var(--card-border, #e4e4e7);
    color: #111;
  }
  html.dark .icon-badge--neutral {
    background: #27272a;
    color: #fff;
  }
  .icon-badge--danger {
    background: #dc2626;
    color: #fff;
  }
  html.dark .icon-badge--danger {
    background: #dc2626;
    color: #fff;
  }

  .os-surface {
    @apply bg-white dark:bg-neutral-900 border border-neutral-200 dark:border-neutral-800 rounded-os shadow-os;
  }
  .os-subtle {
    @apply bg-neutral-50 dark:bg-neutral-900/40 border border-neutral-200/70 dark:border-neutral-800/80 rounded-os text-sm;
  }
  .os-divider {
    @apply border-t border-neutral-200 dark:border-neutral-800;
  }
  .os-muted {
    @apply text-neutral-500 dark:text-neutral-400;
  }
  .os-strong {
    @apply text-neutral-900 dark:text-neutral-100;
  }
  .os-card-title {
    font-weight: 600;
  }

  .os-header {
    @apply sticky top-0 z-40 bg-white/70 dark:bg-neutral-950/60 backdrop-blur border-b border-neutral-200 dark:border-neutral-800;
  }
  .os-header-inner {
    @apply h-14 px-4 flex items-center gap-3;
  }
  .os-header-title {
    @apply text-sm font-semibold tracking-wide;
  }
  .os-header-kpi {
    @apply inline-flex items-center gap-1 rounded-os-sm px-2 py-1 border border-neutral-200 dark:border-neutral-800 text-[11px] os-muted bg-neutral-50 dark:bg-neutral-900;
  }

  .os-sidebar {
    @apply bg-white dark:bg-neutral-950 border-r border-neutral-200 dark:border-neutral-800;
  }
  .os-sidebar-label {
    @apply px-3 pb-2 text-[10px] font-semibold tracking-wider uppercase os-muted;
  }
  .os-nav-link {
    @apply flex items-center gap-2 px-3 py-2 rounded-os-sm text-[0.8rem] text-neutral-600 dark:text-neutral-300 hover:text-neutral-900 hover:bg-neutral-50 dark:hover:text-neutral-100 dark:hover:bg-neutral-900 transition;
  }
  .os-nav-link[aria-current='page'],
  .os-nav-link.is-active {
    @apply bg-neutral-100 dark:bg-neutral-900 text-neutral-900 dark:text-neutral-100 font-medium border border-neutral-200 dark:border-neutral-800;
  }
  .os-icon {
    @apply w-4 h-4;
    color: currentColor;
    stroke: currentColor;
  }
  .panel-surface {
    @apply backdrop-blur-sm border border-[var(--card-border)] rounded-xl p-5 shadow-sm transition-all;
    background: color-mix(in srgb, var(--card-bg) 80%, transparent);
    box-shadow: 0 1px 2px rgba(0, 0, 0, 0.08);
  }
  .panel-surface:hover {
    box-shadow: 0 4px 12px -2px rgba(0, 0, 0, 0.15);
  }
  .panel-header {
    @apply flex items-center justify-between mb-4;
  }
  .panel-title {
    @apply text-base font-semibold tracking-wide;
  }

  .form-grid {
    @apply grid gap-5 md:grid-cols-2;
  }
  .field {
    @apply flex flex-col gap-1;
  }
  .field-label {
    @apply text-xs font-semibold uppercase tracking-wide text-[var(--text-secondary)];
  }
  .input,
  .select,
  .textarea {
    @apply border border-[var(--card-border)] rounded-lg px-3 py-2 text-sm focus:outline-none transition;
    background: color-mix(in srgb, var(--card-bg) 60%, transparent);
  }
  .input:focus,
  .select:focus,
  .textarea:focus {
    outline: 1px solid transparent;
    outline-offset: 1px;
    --tw-ring-offset-shadow: var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width)
      var(--tw-ring-offset-color);
    --tw-ring-shadow: var(--tw-ring-inset) 0 0 0 calc(1px + var(--tw-ring-offset-width)) #777777;
    box-shadow:
      var(--tw-ring-offset-shadow), var(--tw-ring-shadow), var(--tw-shadow, 0 0 #00000000);
  }

  .btn {
    @apply inline-flex items-center gap-2 px-4 py-2 rounded-lg text-sm font-medium bg-primary-600 text-white hover:bg-primary-500 transition-colors focus:outline-none focus-visible:ring-2;
  }
  .btn-outline {
    @apply inline-flex items-center gap-2 px-4 py-2 rounded-lg text-sm font-medium border border-[var(--card-border)] hover:bg-[var(--bg-chat)] transition-colors;
  }

  .btn {
    @apply inline-flex items-center gap-2 px-4 py-2 rounded-lg text-sm font-medium tracking-wide select-none;
    background: #553fee;
    color: #fff;
  }
  .btn:hover {
    background: #6366f1;
  }
  .btn:active {
    @apply scale-[.97];
  }
  .btn:focus-visible {
    @apply outline-none ring-2 ring-offset-0;
    --tw-ring-color: rgba(148, 163, 184, 0.5);
  }
  .btn-primary {
    @apply btn;
  }

  .btn-save {
    @apply inline-grid grid-flow-col place-items-center gap-2 px-4 py-2 rounded-lg text-sm font-medium text-white transition-colors focus:outline-none focus-visible:ring-2;
    background: #553fee;
    --tw-ring-color: rgba(148, 163, 184, 0.5);
  }
  .btn-save:hover {
    background: #6366f1;
  }
  .btn-save:disabled {
    @apply opacity-60 cursor-not-allowed;
  }

  .btn-secondary {
    @apply inline-flex items-center gap-2 px-4 py-2 rounded-lg text-sm font-medium bg-[var(--bg-card)] text-[var(--text-primary)] border border-[var(--card-border)] hover:bg-[var(--bg-chat)] transition-colors;
  }
  .btn-compact-secondary {
    @apply inline-flex items-center gap-2 rounded-lg text-sm font-medium bg-[var(--bg-card)] text-[var(--text-primary)] border border-[var(--card-border)] hover:bg-[var(--bg-chat)] transition-colors;
    padding: 6px 12px;
  }
  .btn-ghost {
    @apply inline-flex items-center gap-2 px-3 py-2 rounded-lg text-sm font-medium text-[var(--text-secondary)] hover:text-[var(--text-primary)] hover:bg-[var(--bg-chat)] transition-colors;
  }
  .btn-outline {
    @apply inline-flex items-center gap-2 px-4 py-2 rounded-lg text-sm font-medium border border-[var(--card-border)] text-[var(--text-primary)] hover:bg-[var(--bg-chat)] transition-colors;
  }

  html:not(.dark) .btn-outline:hover {
    background: #111 !important;
    color: #fff !important;
  }

  html:not(.dark) .btn {
    color: #fff !important;
  }
  html:not(.dark) .btn-save {
    color: #fff !important;
  }

  html:not(.dark) .btn.btn-secondary,
  html:not(.dark) .btn.btn-compact-secondary {
    color: var(--text-primary) !important;
  }

  .btn-danger,
  .btn.danger {
    @apply inline-flex items-center gap-2 px-4 py-2 rounded-lg text-sm font-medium text-white focus-visible:ring-2;
    background: #1e1e1e;
    color: #fff;
  }

  html:not(.dark) .btn-danger,
  html:not(.dark) .btn.danger {
    color: #fff;
  }
  .btn-danger:hover,
  .btn.danger:hover {
    background: #2f343a;
  }
  .btn-danger:active,
  .btn.danger:active {
    background: #272b30;
  }
  .btn-danger:focus-visible,
  .btn.danger:focus-visible {
    @apply ring-offset-0 ring-2;
    --tw-ring-color: rgba(148, 163, 184, 0.5);
  }
  .btn-success {
    @apply inline-flex items-center gap-2 px-4 py-2 rounded-lg text-sm font-medium text-white bg-[#16a34a] hover:bg-[#15803d] focus-visible:ring-2;
    --tw-ring-color: rgba(148, 163, 184, 0.5);
  }
  .btn-warning {
    @apply inline-flex items-center gap-2 px-4 py-2 rounded-lg text-sm font-medium text-[#1e1e1e] bg-[#f59e0b] hover:bg-[#d97706] focus-visible:ring-2;
    --tw-ring-color: rgba(148, 163, 184, 0.5);
  }
  .btn.disabled,
  .btn[disabled] {
    @apply opacity-60 cursor-not-allowed;
  }

  .os-table {
    @apply w-full rounded-os-sm border border-neutral-200 dark:border-neutral-800 overflow-hidden;
  }
  .os-tr {
    @apply grid grid-cols-12;
  }
  .os-th {
    @apply px-3 py-2 text-[12px] font-semibold tracking-wide text-neutral-600 dark:text-neutral-300 border-b border-neutral-200 dark:border-neutral-800;
  }
  .os-td {
    @apply px-3 py-2 text-sm text-neutral-800 dark:text-neutral-200 border-b border-neutral-200 dark:border-neutral-800;
  }

  .os-table > .os-tr:first-child .os-th {
    @apply bg-neutral-50 dark:bg-neutral-900;
  }

  .os-table > .os-tr:last-child .os-td {
    @apply border-b-0;
  }

  .os-table.social-media > .os-tr {
    grid-template-columns:
      44px minmax(140px, 2fr) minmax(220px, 4fr) minmax(120px, 1.5fr)
      minmax(120px, 2fr) max-content;
  }
  .os-table.social-media .num {
    @apply px-1 text-center;
  }
  .os-table.social-media .actions {
    justify-self: end;
  }

  .badge {
    @apply inline-flex items-center gap-1 px-2 py-1 rounded-md text-[10px] font-semibold uppercase tracking-wide bg-[var(--bg-chat)] border border-[var(--card-border)];
  }
  .divider {
    @apply my-6 border-t border-[var(--card-border)];
  }

  .input-group {
    @apply flex items-stretch w-full rounded-lg overflow-hidden border border-[var(--card-border)] backdrop-blur-sm;
    background: color-mix(in srgb, var(--card-bg) 60%, transparent);
  }
  .input-group input {
    @apply flex-1 px-3 py-2 text-sm border-0 rounded-none;
  }
  .input-group button {
    @apply btn-primary px-4 py-2 rounded-none shadow-none border-l border-[var(--card-border)];
    background: #111;
  }
  .input-group button:hover {
    background: #553fee;
  }
  .input-group-sm {
    @apply rounded-md;
  }
  .input-group-sm input {
    @apply px-2 py-1 text-xs;
  }
  .input-group-sm button {
    @apply px-3 py-1 text-xs;
  }

  @media (max-width: 640px) {
    .copy-field-group {
      flex-wrap: wrap;
    }

    .copy-field-group input {
      flex: 1 1 100%;
      min-width: 0;
    }

    .copy-field-group button {
      border-left: 0;
      border-top: 1px solid var(--card-border);
    }
  }

  .admin-layout {
    --sidebar-w: 14rem;
    min-height: calc(100vh - var(--admin-top, var(--admin-header-h, 64px)) - 2.5rem);
  }
  .sidebar-collapsed {
    --sidebar-w: 4rem;
  }
  .admin-sidebar {
    @apply flex flex-col gap-4 pr-4 border-r border-[var(--card-border)] backdrop-blur-sm transition-all duration-300;
    background: var(--bg-card);
    box-sizing: border-box;
  }

  @media (max-width: 767.98px) {
    .admin-layout {
      padding-left: 0;
    }
    .admin-sidebar {
      position: fixed;
      top: var(--admin-top, var(--admin-header-h, 64px));
      left: 0;
      height: calc(100vh - var(--admin-top, var(--admin-header-h, 64px)));
      width: 16rem;
      transform: translateX(-100%);
      z-index: 60;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.25);
      background: var(--bg-card);
    }
    html.mobile-sidebar-open .admin-sidebar {
      transform: translateX(0);
    }
    .admin-overlay {
      position: fixed;
      inset: 0;
      top: var(--admin-top, var(--admin-header-h, 64px));
      background: rgba(0, 0, 0, 0.35);
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.2s ease;
      z-index: 50;
    }
    html.mobile-sidebar-open .admin-overlay {
      opacity: 1;
      pointer-events: auto;
    }
  }
  @media (min-width: 768px) {
    .admin-layout {
      padding-left: var(--sidebar-w, 14rem);
    }
    .admin-sidebar {
      position: fixed;
      left: var(--container-left, 0px);
      top: var(--admin-top, var(--admin-header-h, 64px));
      width: var(--sidebar-w, 14rem);
      height: calc(100vh - var(--admin-top, var(--admin-header-h, 64px)));
      overflow-x: visible;
      z-index: 40;
    }
  }
  .admin-main {
    min-height: calc(100vh - var(--admin-top, var(--admin-header-h, 64px)) - 2.5rem);
    display: flex;
    flex-direction: column;
  }
  .admin-main-content {
    flex: 1 0 auto;
    padding-bottom: 2.5rem;
  }
  .admin-main > footer {
    margin-top: auto;
  }
  .sidebar-collapsed .admin-sidebar {
    @apply w-16 pr-0;
  }
  .sidebar-collapsed .admin-sidebar .sidebar-title {
    @apply opacity-0;
  }
  .sidebar-collapsed .admin-sidebar .sidebar-link span:last-child {
    @apply hidden;
  }
  .sidebar-toggle-btn {
    @apply absolute -right-3 top-4 w-6 h-6 rounded-full bg-[var(--bg-chat)] flex items-center justify-center text-xs cursor-pointer shadow-sm hover:bg-[var(--card-bg)] transition;
    z-index: 120;
  }
  .sidebar-toggle-icon {
    @apply transition-transform duration-300;
  }
  .sidebar-collapsed .sidebar-toggle-icon {
    @apply -rotate-180;
  }
  .sidebar-section {
    @apply flex flex-col gap-2;
  }
  .sidebar-title {
    @apply text-xs uppercase tracking-wider font-semibold text-[var(--text-secondary)] px-2;
  }
  .sidebar-nav .sidebar-link {
    @apply rounded-lg px-3 py-2 text-sm font-medium text-[var(--text-secondary)] hover:text-[var(--text-primary)] transition-colors relative;
  }

  .sidebar-collapsed .sidebar-nav .sidebar-link {
    padding: 0.5rem 1.4rem;
  }
  .sidebar-nav .sidebar-link.active {
    @apply text-[var(--text-primary)] bg-[var(--bg-chat)] font-semibold;
  }
  .sidebar-nav .sidebar-link .icon {
    @apply opacity-70 transition-opacity;
  }
  .sidebar-nav .sidebar-link:hover .icon,
  .sidebar-nav .sidebar-link.active .icon {
    @apply opacity-100;
  }
  .sidebar-nav .sidebar-link.active .icon {
    color: #de0048;
  }
  html.dark .sidebar-nav .sidebar-link.active .icon {
    color: #28f172;
  }

  .field-error .input,
  .field-error .select,
  .field-error .textarea {
    @apply border-red-500 focus:ring-red-500 focus:border-red-500;
  }
  .field-error .field-label {
    @apply text-red-500;
  }
  .field-hint {
    @apply text-[11px] text-[var(--text-secondary)] mt-1 italic;
  }
  .field-error .field-hint {
    @apply text-red-500 not-italic;
  }

  .tip-title {
    @apply font-semibold mb-0.5;
  }
  .tip-subtle {
    opacity: 0.9;
  }
  .tip-viewers {
    opacity: 0.95;
    color: var(--text-primary, #0f172a);
  }
  html.dark .tip-viewers {
    color: var(--text-primary, #f8fafc);
  }

  .skeleton {
    @apply relative overflow-hidden bg-[var(--bg-chat)] rounded;
  }
  .skeleton:after {
    content: '';
    position: absolute;
    inset: 0;
    background: linear-gradient(
      110deg,
      transparent 0%,
      rgba(255, 255, 255, 0.15) 40%,
      rgba(255, 255, 255, 0.2) 50%,
      transparent 60%
    );
    animation: skeleton-shimmer 1.4s linear infinite;
  }
  .dark .skeleton {
    background: color-mix(in srgb, var(--card-bg) 60%, #000);
  }
  @keyframes skeleton-shimmer {
    0% {
      transform: translateX(-100%);
    }
    100% {
      transform: translateX(100%);
    }
  }

  .skeleton-avatar {
    @apply skeleton rounded-full w-10 h-10;
  }
  .skeleton-line {
    @apply skeleton h-3 w-full;
  }
  .skeleton-line-sm {
    @apply skeleton h-2 w-1/2;
  }
  .skeleton-block {
    @apply skeleton h-24 w-full;
  }

  input[type='checkbox']:not(.checkbox) {
    @apply w-4 h-4 rounded border border-[var(--card-border)] bg-transparent cursor-pointer align-middle appearance-none transition;
    box-shadow: 0 0 0 0 rgba(0, 0, 0, 0);
    display: inline-flex;
    justify-content: center;
    align-items: center;
  }
  input[type='checkbox']:not(.checkbox):hover {
    background: color-mix(in srgb, var(--card-bg) 85%, transparent);
  }
  input[type='checkbox']:not(.checkbox):focus-visible {
    @apply outline-none ring-2 ring-offset-0;
    --tw-ring-color: rgba(148, 163, 184, 0.5);
  }
  input[type='checkbox']:not(.checkbox):checked {
    background: #553fee;
    border-color: #553fee;
  }
  html.dark input[type='checkbox']:not(.checkbox) {
    background: color-mix(in srgb, var(--card-bg) 70%, transparent);
  }
  html.dark input[type='checkbox']:not(.checkbox):hover {
    background: color-mix(in srgb, var(--card-bg) 55%, transparent);
  }
  html.dark input[type='checkbox']:not(.checkbox):checked {
    background: #553fee;
    border-color: #553fee;
  }

  .checkbox-wrapper-2 {
    display: inline-flex;
    align-items: center;
  }
  input[type='checkbox'].checkbox {
    appearance: none;
    -webkit-appearance: none;
    @apply cursor-pointer align-middle;
    position: relative;
    width: 34px;
    height: 21px;
    border-radius: 999px;
    border: 1px solid var(--card-border);
    background-color: color-mix(in srgb, var(--card-bg) 75%, transparent);
    transition:
      background-color 120ms ease-out,
      box-shadow 120ms ease-out;
    flex-shrink: 0;
    margin: 0;
  }
  input[type='checkbox'].checkbox::before {
    content: '';
    position: absolute;
    inset: -6px;
  }
  input[type='checkbox'].checkbox::after {
    content: '';
    position: absolute;
    top: 3px;
    left: 3px;
    width: 14px;
    height: 14px;
    border-radius: 50%;
    background-color: #fff;
    transition:
      transform 120ms ease-out,
      left 120ms ease-out,
      background-color 120ms ease-out;
    box-shadow: 0 1px 2px rgba(0, 0, 0, 0.15);
  }
  input[type='checkbox'].checkbox:hover {
    background-color: color-mix(in srgb, var(--card-bg) 65%, transparent);
    transition-duration: 0s;
  }
  input[type='checkbox'].checkbox:focus-visible {
    outline: none;
    box-shadow: 0 0 0 3px rgba(148, 163, 184, 0.5);
  }
  input[type='checkbox'].checkbox:checked {
    background-color: #553fee;
    border-color: #553fee;
  }
  input[type='checkbox'].checkbox:checked::after {
    left: 17px;
  }
  input[type='checkbox'].checkbox:checked:hover {
    background-color: #111;
  }
  input[type='checkbox'].checkbox:disabled {
    @apply opacity-60 cursor-not-allowed;
  }
  html.dark input[type='checkbox'].checkbox {
    background-color: color-mix(in srgb, var(--card-bg) 60%, transparent);
  }
  html.dark input[type='checkbox'].checkbox:hover {
    background-color: color-mix(in srgb, var(--card-bg) 50%, transparent);
  }

  input[type='color'] {
    -webkit-appearance: none;
    border: 1px solid var(--card-border);
    @apply rounded-sm w-10 h-10 p-0 cursor-pointer overflow-hidden;
    background: transparent;
  }
  input[type='color']::-webkit-color-swatch-wrapper {
    padding: 0;
  }
  input[type='color']::-webkit-color-swatch {
    border: none;
    border-radius: 4px;
  }
  input[type='color']:focus-visible {
    @apply outline-none ring-2;
    --tw-ring-color: rgba(148, 163, 184, 0.5);
  }
}

::-webkit-scrollbar {
  width: 10px;
  height: 10px;
}
::-webkit-scrollbar-track {
  background: transparent;
}
::-webkit-scrollbar-thumb {
  background: rgba(120, 131, 149, 0.35);
  border: 2px solid transparent;
  background-clip: content-box;
  border-radius: 20px;
}
::-webkit-scrollbar-thumb:hover {
  background: rgba(120, 131, 149, 0.55);
  border: 2px solid transparent;
}

html.dark ::-webkit-scrollbar-thumb {
  background: rgba(120, 131, 149, 0.4);
}
html.dark ::-webkit-scrollbar-thumb:hover {
  background: rgba(120, 131, 149, 0.65);
}
